# 💘 恋愛漫画シナリオ生成ツールv2

愛カツメディア向けの、バズる恋愛漫画シナリオを自動生成するツールです。
1日10本のシナリオ作成を目指し、非エンジニアでも簡単に使えるように設計されています。

**このバージョンは新機能開発用のv2です。元のツールは別フォルダで稼働中です。**

## 🌟 特徴

### コア機能
- **包括的なリサーチに基づく生成**: ショートドラマ、SNSバズ、セールスライティング、ストーリーテリング理論を統合
- **前後編2話完結形式**: 前後編でそれぞれ完結しつつ、後編を絶対に読みたくなる構造
- **8つのトーン選択**: 甘々、切ない、コメディなど多彩な雰囲気
- **バズる要素を自動分析**: 共感ポイント、意外性、胸キュンシーンなどを明示
- **自動品質チェック**: 生成されたシナリオを自動でチェックし、リライトして品質向上

### v2.1.0の新機能（ブラッシュアップ版）
- ✨ **モダンなUI/UX**: グラデーションデザイン、カード型レイアウト、アニメーション効果
- 🔍 **検索機能**: テーマ、トーン、内容で履歴を検索可能
- ⭐ **お気に入り機能**: 気に入ったシナリオをブックマーク
- ✏️ **シナリオ編集機能**: 生成されたシナリオを直接編集可能
- 📊 **統計情報**: 総生成数、トーン別統計を可視化
- 🛡️ **強化されたエラーハンドリング**: 分かりやすいエラーメッセージと解決方法の提示
- 📈 **進捗表示の改善**: 生成過程を視覚的に表示

### その他の機能
- **履歴管理機能**: 過去の生成結果を自動保存
- **ダウンロード機能**: テキスト/Markdown形式でエクスポート
- **文字数カウント**: 自動で文字数をカウントし、制限をチェック

## 📋 必要なもの

1. **Python 3.8以上**
2. **Anthropic API Key**: [Anthropicコンソール](https://console.anthropic.com/)で取得

## 🚀 セットアップ方法

### 1. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

### 2. APIキーの設定

**方法1: アプリ内で保存（推奨）**

1. アプリを起動
2. サイドバーのAPI Key入力欄にキーを入力
3. 「💾 APIキーを保存」ボタンをクリック
4. 次回起動時から自動的に読み込まれます

**方法2: 手動で.envファイルを作成**

`.env.example`をコピーして`.env`ファイルを作成し、APIキーを設定します：

```bash
cp .env.example .env
```

`.env`ファイルを編集：

```
ANTHROPIC_API_KEY=sk-ant-api03-...あなたのAPIキー...
```

### 3. アプリの起動

**方法1: 起動スクリプトを使う（推奨）**

```bash
./start.sh
```

**方法2: 直接起動**

```bash
streamlit run app.py
```

ブラウザが自動で開き、`http://localhost:8508`でアプリが起動します。

**注意**: このツールはポート8508を使用します（他のツールと重複しないため）。

## 📖 使い方

### 基本的な使い方

1. **サイドバーで設定**
   - APIキーを入力（.envに設定していない場合）
   - 💾 APIキーを保存ボタンで保存すると次回から自動入力されます
   - トーン/雰囲気を選択（形式は前後編に固定）
   - 統計情報を確認（総生成数、トーン別統計など）

2. **テーマ/ネタを入力**
   - 作りたい漫画のテーマやシチュエーションを自由に入力
   - 具体的であればあるほど良いシナリオが生成されます

3. **追加の要望（オプション）**
   - 主人公の設定
   - 相手役のキャラクター
   - 入れてほしいシーン
   - 希望する結末など

4. **「シナリオを生成する」ボタンをクリック**
   - 進捗バーで生成過程を確認
   - 約1〜2分でシナリオが生成されます
   - 自動で品質チェックとリライトが実行されます

5. **結果の活用**
   - 画面上で確認
   - ✏️ シナリオを編集（編集機能を使用）
   - ⭐ お気に入りに追加
   - 📄 テキスト/Markdown形式でダウンロード
   - 📚 履歴から過去のシナリオを確認・検索

### テーマ例

#### 職場恋愛
- 冷たい上司が私にだけ優しい理由
- 同期のライバルが実は私のことを...
- 転職先の元カレが上司だった

#### 学園恋愛
- 10年ぶりに再会した初恋の幼馴染
- 先輩に突然告白されたけど信じられない
- クラスで一番モテる彼が私だけに見せる顔

#### 切ない系
- 両想いなのに結ばれない二人
- 最後の夏に始まった恋
- 婚約者がいる人を好きになってしまった

#### 王道胸キュン
- 偽装恋愛から始まる本当の恋
- 一目惚れした人が実は...
- 三角関係から始まる運命の恋

## 📁 ファイル構成

```
恋愛漫画シナリオ生成ツールv2/
├── app.py                          # メインアプリケーション
├── start.sh                        # 起動スクリプト（ポート8508）
├── requirements.txt                # 依存パッケージ
├── .env.example                    # API設定のサンプル
├── .env                            # APIキー保存先（自動生成、Gitには含まれない）
├── .gitignore                      # Git除外設定
├── README.md                       # このファイル
├── .streamlit/
│   └── config.toml                 # Streamlit設定
├── prompts/
│   └── 恋愛漫画マスタープロンプト.md  # シナリオ生成用プロンプト
├── research/
│   └── リサーチ結果まとめ.md         # リサーチデータ
└── output/                         # 生成履歴の保存先
    ├── scenario_YYYYMMDD_HHMMSS.json  # 生成履歴
    └── favorites.json                  # お気に入りリスト（自動生成）
```

## 🎯 生成されるシナリオの内容

1. **記事タイトル案（3案）**: バズるタイトルを3パターン提示
2. **あらすじ**: 物語全体の流れを200-300文字で
3. **登場人物**: 主人公、相手役、サブキャラクターの設定
4. **山場**: クライマックスシーンの詳細
5. **オチ**: 結末と余韻
6. **バズる要素**: 共感ポイント、意外性、胸キュンシーン、SNS映え要素など
7. **ページごとの簡易構成**: 各ページの内容を具体的に

## 💡 効果的なシナリオ生成のコツ

### テーマ入力のポイント
- **具体的に書く**: 「恋愛の話」より「冷たい上司が私にだけ優しい」
- **シチュエーションを明確に**: 場所、関係性、きっかけなど
- **感情を入れる**: 切ない、ドキドキ、もどかしい など

### バリエーションを増やすには
- 同じテーマでもトーンを変える
- 形式を変える（1話完結→前後編など）
- キャラクター設定を変える（年齢、職業など）
- 障害の種類を変える（第三者、環境、内面の葛藤）

### 1日10本作成のワークフロー
1. 朝：切ない系3本（通勤時間に読まれやすい）
2. 昼：甘々系3本（お昼休憩のリラックスタイム向け）
3. 夕方：コメディ系2本（疲れた時に笑える）
4. 夜：ドロドロ系2本（ゴールデンタイム向け）

### 新機能の使い方

#### 🔍 検索機能
- サイドバーの「🔍 検索」欄でテーマ、トーン、内容を検索できます
- フィルターで「お気に入りのみ」を選択すると、お気に入りしたシナリオだけを表示

#### ⭐ お気に入り機能
- 履歴リストの各シナリオ横の「⭐」ボタンでお気に入りに追加/削除
- 詳細画面でもお気に入りに追加可能

#### ✏️ シナリオ編集機能
- 生成されたシナリオ画面の「✏️ シナリオを編集」を開く
- テキストエリアで直接編集
- 「💾 保存」ボタンで更新を保存

#### 📊 統計情報
- サイドバーの「📊 統計情報」で総生成数、お気に入り数を確認
- トーン別統計で人気のトーンを確認可能

## 🔧 トラブルシューティング

### APIキーエラーが出る
- APIキーが正しいか確認
- [Anthropicコンソール](https://console.anthropic.com/)でクレジットがあるか確認

### 生成が遅い/止まる
- インターネット接続を確認
- 複雑すぎるテーマの場合、もう少しシンプルに
- APIの使用制限を確認

### 履歴が表示されない
- `output/`フォルダが存在するか確認
- サイドバーの「履歴を更新」ボタンをクリック

### ポート8508が既に使用されている
- 他のアプリケーションがポート8508を使用している場合、`start.sh`のポート番号を変更してください
- 例：`--server.port 8509`に変更

## 📊 リサーチに基づく機能

このツールは以下の分野を徹底リサーチして開発されました：

1. **ショートドラマのシナリオ構造**: 縦型動画、1テーマ=1感情動線
2. **SNSでバズる恋愛コンテンツ**: TikTok、Instagram、Twitterの傾向分析
3. **タイトル・サムネイルの法則**: クリック率を上げるパワーワード
4. **恋愛漫画のストーリーパターン**: 王道展開、胸キュンシチュエーション
5. **セールスライティング**: AIDMA、PASONA、QUESTの法則
6. **バズの法則**: 共感×意外性×拡散しやすい形
7. **ストーリーテリング理論**: 起承転結、三幕構成、ヒーローズジャーニー
8. **胸キュンシチュエーション**: バックハグ、壁ドン、頭ポンポンなど

詳細は`research/リサーチ結果まとめ.md`をご覧ください。

## 📞 サポート

質問や要望がありましたら、愛カツ編集部までお問い合わせください。

## 📝 ライセンス

このツールは愛カツメディア専用です。

---

**Happy Scenario Writing! 💘**
